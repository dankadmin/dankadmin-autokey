echo "Logged in email: "; zcat /var/log/exim_mainlog?*|cat /var/log/exim_mainlog - | awk 'match($0, /(courier|dovecot)_(plain|login):([^ ]+)/, a)&&a[3]!~/__cpanel__/{print a[3]}' |sort|uniq -c|sort -n|awk '{l++;t=t+$1;print}END{printf "\n\tTotal: %d\t Entries: %d\n\n",t,l}'  |tail -23 ; echo -e "\nEmail from scripts: "; zcat /var/log/exim_mainlog?*|cat /var/log/exim_mainlog - | LC_ALL=C grep cwd|awk -F'=' '{print $2}'|cut -d' ' -f1|sort|uniq -c|sort -n|tail -20 ; echo -e "\nSpoofing: "; CPDOMAINS=$(sudo grep DNS /var/cpanel/users/* | awk -F'=' '{printf $2 "|"} END {printf "fencepostfu"}');zcat /var/log/exim_mainlog?*|cat /var/log/maillog -|awk "match(tolower(\$0),/<= ([^@ ]+)@([^ ]+).*(courier|dovecot)_(plain|login):([^@ ]+)(@|\+)($CPDOMAINS)/,a) { if (a[2] "\!\~" /$CPDOMAINS/) print a[5]\"@\"a[7]\" \"a[1]\"@\"a[2]}" |sort|uniq|cut -d' ' -f1|sort|uniq -c|sort -rn|awk '{print "\t"$2" sent as "$1" cross-server addresses"}'|head -10 