find /home/ -name '*.php' -exec perl -MTerm::ANSIColor -ne 'BEGIN{$v="noneyet"}$v=$2 if m/^(\s*\$([a-z][a-zA-Z._]*)\s*=\s*)(\$_(GET|POST|REQUEST)\[.([a-zA-Z._]+).\]);/; $v="noneyet" if m/((en|de)code|htmlentities|addslashes|preg|replace|sani|valid|match|sub|filter|->).*$v/;print "$ARGV:\t $1",color("red"),"$3",color("reset"),"$4\n\n" if m/^\s*(.*(mysql_|\$)query\b.*)(\$$v)(\b.*)/i' {} \;