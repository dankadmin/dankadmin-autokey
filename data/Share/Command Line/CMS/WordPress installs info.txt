for db in $(mysql -BNe "show databases;"); do table=$(mysql $db -BNe "show tables like '%options';"); pre=${table%options}; url=$(mysql $db -BNe "select option_value from ${pre}options where option_name='siteurl';" 2>/dev/null);if [ -n "$url" ]; then dr=$(cat /usr/local/apache/conf/httpd.conf |awk -v url=$url 'BEGIN{match(url,"(http://)?([^/]+)(.*)$",a);domain=a[2];file=a[3]}$0~"Server(Name|Alias).* "domain{d=1}d&&/DocumentRoot/{print $2""file;exit}'); echo "db: $db prefix: ${pre} siteurl: $url docroot: $dr"; fi; done