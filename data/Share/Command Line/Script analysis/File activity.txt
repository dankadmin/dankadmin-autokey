HTTP_HOST="$host" REQUEST_URI="$uri" time strace -e open,close,read,write -Trf php $file 2>&1 |awk 'BEGIN{fd[0]="STDIN";fd[1]="STDOUT";fd[2]="STDERR"}match($0,/open\("([^"]+)"[^=]*= ([0-9-]+)/,o){if(o[2]~/-1/){print "Failed to open "o[1]}else{fd[o[2]]=o[1];print "Opened "fd[o[2]]" on "o[2]}}match($0,/close\(([0-9]+)\)/,c){print "Closing "fd[c[1]]" on "c[1];fd[c[1]]="closed"}match($0,/(read|write|poll|select)\(([0-9]+)/,f){print f[1]" on "fd[f[2]]}'